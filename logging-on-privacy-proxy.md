The following interactions are currently logged on the privacy proxy (all including a timestamp, origin and, if sent by the extension, a uuid):
* query (+ whole user profile as shown below)
* results (+ weighted query keywords and federated response)
* show/hide extension (+ current url)
* open/close result (+ result url, corresponding query, duration)
* rating (+ resource url, rating value [1|2])
* FacetScape {mode:<"selection" | "deselection" | "include" | "exclude" | "move">,facetName,facetValue,uuid} in separate logfile



User Profile logged along with a query (as sent by the extension):
```javascript
{
	"eexcess-user-profile" : {
		/* filled according to privacy policy */
		"history" : [{
				"id" : "3",
				"lastVisitTime" : 1403019076069.657,
				"title" : "Loom - Wikipedia, the free encyclopedia",
				"typedCount" : 0,
				"url" : "http://en.wikipedia.org/wiki/Loom",
				"visitCount" : 18
			}
		],
		"firstname" : "max",
		"lastname" : "mustermann",
		"gender" : "",
		"birthdate" : "2013-05-07",
		"address" : {
			"country" : "im nirgendwo",
			"zipcode" : "12345",
			"city" : "irgendwo",
			"line1" : "hinterm",
			"line2" : "berg"
		},
		"interests" : {
			"interest" : [{
					"text" : "Recommender systems",
					"weight" : "1.0",
					"uri" : "http://dbpedia.org/resource/Category:Recommender_systems"
				}, {
					"text" : "bratwurst",
					"weight" : "1.0"
				}
			]
		},
		
		/* always present */
		"context-list" : {
			"context" : [{
					"weight" : 1,
					"text" : "loom"
				}
			],
			"reason" : {
				/* one of the following types:
					- manual (input in search box)
					- selection (user selected a piece of text)
					- page (automatic query on page load)
					- queryCrumbs (query reissued by navigation in queryCrumbs)
				*/
				"reason" : "manual",
				/* this attribute contains contextual text, e.g. if the user selects a piece of text and issues a query manual, the selection is still present and included here */
				"text" : "loom"
			}
		}
	},
	"uuid" : "B68EFBD7-106C-40BA-AB5C-A5030F55958E" // user identifier generated by extension
}
```

# logging endpoints
The logs for query and result do not require a specific endpoint (samples can be found at the bottom). Other logging endpoints:
* **/log/rating** rating of a resource
* **/log/rview** detail view of a resource opened
* **/log/rclose** detail view of a resource closed
* **/log/show_hide** visibility of the sidebar toggled
* **/log/facetScape** facetScape interaction

## /log/rating
input:
```javascript
{
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7",
	"rating" : {
		"resource" : "http://europeana.eu/resolve/record/2022350/542DF28412FF874428B9FAB96756B2AE88B3A680",
		"timestamp" : 1404209532893,
		"context" : {
			"query" : "loom"
		},
		"beenRecommended" : true,
		"type" : "rating",
		"annotation" : {
			"@context" : "http://www.w3.org/ns/oa-context-20130208.json",
			"@type" : "oa:Annotation",
			"hasTarget" : {
				"@id" : "http://europeana.eu/resolve/record/2022350/542DF28412FF874428B9FAB96756B2AE88B3A680"
			},
			"hasBody" : {
				"http://purl.org/stuff/rev#rating" : 2,
				"http://purl.org/stuff/rev#minRating" : 1,
				"http://purl.org/stuff/rev#maxRating" : 2
			}
		}
	}
}
```
log entry:  
```
2014-07-01 12:12:12,899 [RATING] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe] 
{
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7",
	"rating" : {
		"resource" : "http://europeana.eu/resolve/record/2022350/542DF28412FF874428B9FAB96756B2AE88B3A680",
		"timestamp" : 1404209532893,
		"context" : {
			"query" : "loom"
		},
		"beenRecommended" : true,
		"type" : "rating",
		"annotation" : {
			"@context" : "http://www.w3.org/ns/oa-context-20130208.json",
			"@type" : "oa:Annotation",
			"hasTarget" : {
				"@id" : "http://europeana.eu/resolve/record/2022350/542DF28412FF874428B9FAB96756B2AE88B3A680"
			},
			"hasBody" : {
				"http://purl.org/stuff/rev#rating" : 2,
				"http://purl.org/stuff/rev#minRating" : 1,
				"http://purl.org/stuff/rev#maxRating" : 2
			}
		}
	}
}
```

## /log/rview
input:
```javascript
{
	"resource" : "http://www.econbiz.de/Record/10009492734",
	"timestamp" : 1404209607918,
	"type" : "view",
	"context" : {
		"query" : "loom"
	},
	"beenRecommended" : true,
	"action" : "result-view",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
log entry:  
```
2014-07-01 12:13:27,958 [RESULT_VIEW] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"resource" : "http://www.econbiz.de/Record/10009492734",
	"timestamp" : 1404209607918,
	"type" : "view",
	"context" : {
		"query" : "loom"
	},
	"beenRecommended" : true,
	"action" : "result-view",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```

## /log/rclose
input:
```javascript
{
	"resource" : "http://www.econbiz.de/Record/10009492734",
	"timestamp" : 1404209607918,
	"type" : "view",
	"context" : {
		"query" : "loom"
	},
	"beenRecommended" : true,
	"id" : 9,
	"duration" : 3451,
	"action" : "result-close",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
log entry:  
```
2014-07-01 12:13:31,376 [RESULT_CLOSE] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"resource" : "http://www.econbiz.de/Record/10009492734",
	"timestamp" : 1404209607918,
	"type" : "view",
	"context" : {
		"query" : "loom"
	},
	"beenRecommended" : true,
	"id" : 9,
	"duration" : 3451,
	"action" : "result-close",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```

## /log/show_hide
input ("visible:false" means, the sidebar was turned off at the currentPage):
```javascript
{
	"visible" : false,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7",
	"currentPage" : "http://en.wikipedia.org/wiki/Loom"
}
```
log entry ("visible:false" means, the sidebar was turned off at the currentPage):  
```
2014-07-01 12:14:27,280 [SHOW_HIDE] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"visible" : false,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7",
	"currentPage" : "http://en.wikipedia.org/wiki/Loom"
}
```

## /log/facetScape
inputs:
```javascript
{
	"mode" : "move",
	"facetName" : "language",
	"facetValue" : null,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
```javascript
{
	"mode" : "selection",
	"facetName" : "year",
	"facetValue" : "2013",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
```javascript
{
	"mode" : "exclude",
	"facetName" : "provider",
	"facetValue" : null,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
```javascript
{
	"mode" : "include",
	"facetName" : "provider",
	"facetValue" : null,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
log entries:  
```
2014-07-01 12:15:54,608 [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
	{
		"mode" : "move",
		"facetName" : "language",
		"facetValue" : null,
		"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
	}
```
```
2014-07-01 12:15:57,092 [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"mode" : "selection",
	"facetName" : "year",
	"facetValue" : "2013",
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
```
2014-07-01 12:15:59,468 [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"mode" : "exclude",
	"facetName" : "provider",
	"facetValue" : null,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```
```
2014-07-01 12:16:55,760 [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"mode" : "include",
	"facetName" : "provider",
	"facetValue" : null,
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```

## query log entry
```
2014-07-01 09:47:56,002 [QUERY] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"eexcess-user-profile" : {
		"history" : [{
				"id" : "3",
				"lastVisitTime" : 1404200541499.711,
				"title" : "Loom - Wikipedia, the free encyclopedia",
				"typedCount" : 1,
				"url" : "http://en.wikipedia.org/wiki/Loom",
				"visitCount" : 30
			}
		],
		"birthdate" : "",
		"address" : {
			"country" : "",
			"zipcode" : "",
			"city" : "",
			"line1" : "",
			"line2" : ""
		},
		"interests" : {
			"interest" : []
		},
		"context-list" : {
			"context" : [{
					"weight" : 1,
					"text" : "loom"
				}
			],
			"reason" : {
				"reason" : "manual",
				"text" : "loom"
			}
		}
	},
	"uuid" : "E993A29B-A063-426D-896E-131F85193EB7"
}
```

## result log entry
```
2014-07-01 09:47:57,706 [RESULT] [userID:E993A29B-A063-426D-896E-131F85193EB7] [origin:chrome-extension://lpelppibhjnlojepdlfpcdolbflghcfe]
{
	"results" : [{
			"provider" : "ZBW",
			"id" : "10009492734"
		}, {
			"provider" : "Europeana",
			"id" : "/2022350/542DF28412FF874428B9FAB96756B2AE88B3A680"
		}, {
			"provider" : "Europeana",
			"id" : "/92022/871327702DD732FD8DE72988738D77E07159B766"
		}, {
			"provider" : "ZBW",
			"id" : "10003942723"
		}, {
			"provider" : "Europeana",
			"id" : "/2022320/6EDA61624C26F34C02B790FB31B3FA8B1B12224C"
		}, {
			"provider" : "Europeana",
			"id" : "/2022350/20C595FA93425DCC255437E865E8FD5218CB533E"
		}, {
			"provider" : "Europeana",
			"id" : "/2022320/DBB5F44C28DCB63A2E117DF8B884986B9D2AEF58"
		}, {
			"provider" : "ZBW",
			"id" : "10010219753"
		}, {
			"provider" : "Europeana",
			"id" : "/2022343/8A1A98A25C53A5BD5F285C5B026ACF83BB3D2E38"
		}, {
			"provider" : "Europeana",
			"id" : "/2022343/C3494560951539055420DDC9CE3B760E2B63D4E0"
		}, {
			"provider" : "ZBW",
			"id" : "10010310985"
		}, {
			"provider" : "ZBW",
			"id" : "10009740462"
		}, {
			"provider" : "ZBW",
			"id" : "10009414705"
		}, {
			"provider" : "Europeana",
			"id" : "/2022320/FF8D044999E1EAF995FF9D102BF71C25B2580347"
		}, {
			"provider" : "Europeana",
			"id" : "/2022343/33B5639C9E85303EA1DB04E130E6A3A81B841EF2"
		}, {
			"provider" : "Europeana",
			"id" : "/92022/1E9687A97769CA6B1A4514B71E17B8958160F3DE"
		}, {
			"provider" : "ZBW",
			"id" : "10008547915"
		}, {
			"provider" : "ZBW",
			"id" : "10008577283"
		}, {
			"provider" : "Europeana",
			"id" : "/2022350/90CFC376B420D8E9C93FB036C6F9019E1CFA637E"
		}, {
			"provider" : "ZBW",
			"id" : "10009144347"
		}, {
			"provider" : "ZBW",
			"id" : "10009568848"
		}, {
			"provider" : "Europeana",
			"id" : "/92022/42AD37EE1B18E06C9EB2AD46469D848F837CF3FB"
		}
	],
	"query" : [{
			"weight" : 1,
			"text" : "loom"
		}
	]
}
``` 
